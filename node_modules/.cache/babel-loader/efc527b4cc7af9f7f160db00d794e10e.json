{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\micae\\\\OneDrive\\\\Documentos\\\\CoinFabrik\\\\webapp-stable-ipfs\\\\src\\\\Components\\\\Modals\\\\MintModal\\\\index.jsx\",\n    _s = $RefreshSig$();\n\n/* eslint-disable default-case */\n\n/* eslint-disable react/jsx-no-target-blank */\nimport { Button, Collapse, Slider } from 'antd';\nimport { SettingFilled } from '@ant-design/icons';\nimport { AuthenticateContext } from '../../../Context/Auth';\nimport './style.scss';\nimport { useState, useContext, useEffect } from 'react';\nimport { Modal, notification } from 'antd';\nimport { convertAmount } from '../../../Lib/exchangeManagerHelper';\nimport { getExchangeMethod } from '../../../Lib/exchangeHelper';\nimport { formatValueToContract, formatValueWithContractPrecision } from '../../../Lib/Formats';\nimport Copy from \"../../Page/Copy\";\nimport { getCurrencyDetail } from '../../../Config/currentcy';\nimport { LargeNumber } from '../../LargeNumber';\nimport { formatLocalMap2 } from '../../../Lib/Formats';\nimport { useTranslation } from \"react-i18next\";\nimport BigNumber from 'bignumber.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function MintModal(props) {\n  _s();\n\n  const isLoggedIn = true; //userAccountIsLoggedIn() && Session.get('rLoginConnected');\n\n  const {\n    exchanging,\n    receiving,\n    title = '',\n    handleClose = () => {},\n    handleComplete = () => {},\n    color,\n    token,\n    fee,\n    interests,\n    visible,\n    onCancel,\n    onConfirm,\n    convertToken,\n    actionIsMint,\n    tolerance,\n    setTolerance,\n    defaultSliderValue,\n    commissionCurrency,\n    valueYouExchange\n  } = props;\n  /* Disabled confirm button when not connected */\n\n  const {\n    address\n  } = true; //window;\n\n  console.log('export default function MintModal(props) {');\n  console.log(fee);\n  console.log(valueYouExchange);\n  console.log('export default function MintModal(props) {');\n  var btnDisable = false;\n\n  if (!address || !isLoggedIn) {\n    btnDisable = true;\n  }\n\n  const [loading, setLoading] = useState(false);\n  const [showTransaction, setShowTransaction] = useState(false);\n  const [transaction, setTransaction] = useState(false);\n  const auth = useContext(AuthenticateContext);\n  const tokenNameExchange = exchanging.currencyCode ? getCurrencyDetail(exchanging.currencyCode).longNameKey : '';\n  const tokenNameReceive = receiving.currencyCode ? getCurrencyDetail(receiving.currencyCode).longNameKey : '';\n  const [currentHash, setCurrentHash] = useState(null);\n  const [comment, setComment] = useState('');\n  const [showError, setShowError] = useState(false);\n  const [t, i18n] = useTranslation([\"global\", 'moc']);\n  const {\n    appMode\n  } = 'Moc';\n  let userComment = '';\n  let userTolerance = '';\n  useEffect(() => {\n    if (currentHash) {\n      console.log('currentHash', currentHash);\n      const interval = setInterval(() => {\n        getTransaction(currentHash);\n      }, 15000);\n      return () => clearInterval(interval);\n    }\n  }, [currentHash]);\n  useEffect(() => {\n    setComment('');\n  }, [visible]);\n  const receivingInUSD = convertAmount(receiving.currencyCode, 'USD', receiving.value, convertToken);\n  /* View */\n\n  const renderAmount = (name, amountAndCurrencyCode, classElement) => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `AlignedAndCentered Amount ${classElement}`,\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"Name\",\n        children: name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: `Value ${amountAndCurrencyCode.currencyCode} ${appMode}`,\n        children: /*#__PURE__*/_jsxDEV(LargeNumber, {\n          currencyCode: amountAndCurrencyCode.currencyCode,\n          amount: amountAndCurrencyCode.value,\n          includeCurrency: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this);\n  };\n\n  const confirmButton = async _ref => {\n    let {\n      comment,\n      tolerance\n    } = _ref;\n    console.log('confirmButtonconfirmButton*******************'); // return false\n    // Check if there are enough spendable balance to pay\n    // take in care amount to pay gas fee\n\n    const minimumUserBalanceToOperate = \"120000000000000\";\n    const userSpendable = await auth.getSpendableBalance(window.address);\n    let minimumBalance = new BigNumber(minimumUserBalanceToOperate);\n    let uTolerance = 0;\n\n    if (actionIsMint) {\n      minimumBalance = minimumBalance.plus(new BigNumber(exchanging.value));\n      uTolerance = tolerance;\n    } // You have not enough balance abort\n\n\n    if (minimumBalance.gt(new BigNumber(userSpendable))) {\n      setShowError(true);\n      return;\n    } // onConfirm({ comment, tolerance: uTolerance });\n\n\n    userComment = comment;\n    userTolerance = uTolerance;\n    /* const { appMode } = window;\r\n    // In rrc20 mode show allowance when need it\r\n    if (appMode === 'RRC20') {\r\n      const userAllowance = await window.nodeManager.getReserveAllowance(window.address);\r\n      if (valueYouExchange > userAllowance) {\r\n        allowanceReserveModalShow(true);\r\n        return;\r\n      }\r\n    } */\n\n    onConfirmTransactionFinish();\n  };\n\n  const onConfirmTransactionFinish = async () => {\n    const exchangeMethod = getExchangeMethod(exchanging.currencyCode, receiving.currencyCode, `${commissionCurrency}_COMMISSION`);\n    let userAmount = formatValueWithContractPrecision(valueYouExchange, 'RESERVE');\n    const userToleranceAmount = formatValueToContract(new BigNumber(userTolerance).multipliedBy(userAmount).div(100).toFixed(), 'RESERVE');\n\n    if (fee.enoughMOCBalance == true) {\n      userAmount = userAmount - window.web3.utils.fromWei((fee.percentage * 100).toString(), 'ether');\n    }\n\n    const userToleranceFormat = new BigNumber(userTolerance).toFixed(); //exchangeMethod(userAmount, userToleranceAmount, callback).then((res) => console.log(res, callback))\n    //auth.interfaceMintRiskPro(userAmount, userToleranceFormat, callback);\n\n    auth.interfaceExchangeMethod(exchanging.currencyCode, receiving.currencyCode, userAmount, userToleranceFormat, onTransaction, onReceipt);\n  };\n\n  const callback = (error, transactionHash) => {\n    setLoading(false);\n    setCurrentHash(transactionHash);\n    setShowTransaction(true);\n    getTransaction(transactionHash);\n  };\n\n  const onTransaction = transactionHash => {\n    setLoading(false);\n    setCurrentHash(transactionHash);\n    setShowTransaction(true);\n    getTransaction(transactionHash);\n  };\n\n  const onReceipt = async receipt => {\n    auth.loadContractsStatusAndUserBalance();\n    const filteredEvents = auth.interfaceDecodeEvents(receipt);\n  };\n\n  const renderError = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"noEnoughBalance\",\n      children: t('global.ConfirmTransactionModal_Error_not_enough')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 5\n    }, this);\n  };\n\n  const getTransaction = async hash => {\n    await auth.getTransactionReceipt(hash, () => {\n      setTransaction(false);\n    }).then(res => {\n      if (res) {\n        setShowTransaction(true);\n        setTransaction(true);\n      }\n    }).catch(e => {\n      setTransaction(false);\n      notification['error']({\n        message: t('global.RewardsError_Title'),\n        description: t('global.RewardsError_Message'),\n        duration: 10\n      });\n    });\n  };\n\n  const changeTolerance = newTolerance => {\n    setTolerance(newTolerance);\n    setShowError(false);\n  };\n\n  const cancelButton = () => {\n    setShowError(false);\n    onCancel();\n  };\n\n  const markStyle = {\n    style: {\n      color: '#707070',\n      fontSize: 10\n    }\n  };\n  const priceVariationToleranceMarks = {\n    0: { ...markStyle,\n      label: '0.0%'\n    },\n    1: { ...markStyle,\n      label: '1%'\n    },\n    2: { ...markStyle,\n      label: '2%'\n    },\n    5: { ...markStyle,\n      label: '5%'\n    },\n    10: { ...markStyle,\n      label: '10%'\n    }\n  };\n  const styleExchange = tokenNameExchange === exchanging.currencyCode ? {\n    color\n  } : {};\n  const styleReceive = tokenNameReceive === receiving.currencyCode ? {\n    color\n  } : {};\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    visible: visible,\n    confirmLoading: loading,\n    className: \"ConfirmModalTransaction\",\n    footer: null,\n    onCancel: cancelButton,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"TabularContent\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: t('global.ConfirmTransactionModal_Title')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this), renderAmount(t('global.ConfirmTransactionModal_Exchanging'), exchanging, 'AmountExchanging'), showError && renderError(), renderAmount(t('global.ConfirmTransactionModal_Receiving'), receiving, 'AmountReceiving'), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"USDConversion\",\n        children: /*#__PURE__*/_jsxDEV(LargeNumber, {\n          currencyCode: 'USD',\n          amount: receivingInUSD,\n          includeCurrency: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Collapse, {\n        className: \"CollapseTolerance\",\n        children: /*#__PURE__*/_jsxDEV(Collapse.Panel, {\n          showArrow: false,\n          header: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"PriceVariationSetting\",\n            children: [/*#__PURE__*/_jsxDEV(SettingFilled, {\n              className: \"icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"SliderText\",\n              children: t(\"global.CustomizePrize_VariationToleranceSettingsTitle\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 53\n          }, this),\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"PriceVariationContainer\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: t(\"global.CustomizePrize_VariationToleranceTitle\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Slider, {\n              className: \"SliderControl\",\n              marks: priceVariationToleranceMarks,\n              defaultValue: defaultSliderValue,\n              min: 0,\n              max: 10,\n              step: 0.1,\n              dots: false,\n              onChange: val => changeTolerance(val)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"AlignedAndCentered\",\n        style: {\n          alignItems: 'start',\n          marginBottom: 20\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Name\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"MOCFee\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `AlignedAndCentered Amount`,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"Name\",\n                children: `${t('global.ConfirmTransactionModal_MOCFee')} (${(fee === null || fee === void 0 ? void 0 : fee.percentage) !== undefined ? fee.percentage : 0.15}%)`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `Value ${appMode}`,\n                children: [auth.isLoggedIn && /*#__PURE__*/_jsxDEV(LargeNumber, {\n                  currencyCode: fee === null || fee === void 0 ? void 0 : fee.currencyCode,\n                  amount: fee === null || fee === void 0 ? void 0 : fee.value,\n                  includeCurrency: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 292,\n                  columnNumber: 19\n                }, this), !auth.isLoggedIn && /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"0.000000 RBTC\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 40\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), interests && (interests === null || interests === void 0 ? void 0 : interests.interestValue) && (interests === null || interests === void 0 ? void 0 : interests.interestValue.gt(0)) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"MOCFee\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `AlignedAndCentered Amount`,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"Name\",\n                children: `${t('global.ConfirmTransactionModal_Interests')} (${interests === null || interests === void 0 ? void 0 : interests.interestRate}%)`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `Value ${appMode}`,\n                children: /*#__PURE__*/_jsxDEV(LargeNumber, {\n                  currencyCode: 'RESERVE',\n                  amount: interests.interestValue,\n                  includeCurrency: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"Legend\",\n            children: t('global.ConfirmTransactionModal_MOCFee_Disclaimer')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      style: {\n        border: '1px solid lightgray',\n        marginTop: 20\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"AlignedAndCentered\",\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"Gray\",\n        children: t('global.ConfirmTransactionModal_AmountMayDifferDisclaimer')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-around',\n        marginTop: '1em'\n      },\n      children: showTransaction ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '100%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              width: '50%',\n              float: 'left'\n            },\n            children: \"Transaction status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              textAlign: 'right',\n              color: transaction ? '#09c199' : '#f1a954'\n            },\n            children: transaction ? 'SUCCESSFUL' : 'PENDING'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              width: '50%',\n              float: 'left'\n            },\n            children: \"Hash\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'right'\n            },\n            children: /*#__PURE__*/_jsxDEV(Copy, {\n              textToShow: (currentHash === null || currentHash === void 0 ? void 0 : currentHash.slice(0, 5)) + '...' + (currentHash === null || currentHash === void 0 ? void 0 : currentHash.slice(-4)),\n              textToCopy: currentHash\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            clear: 'both'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            style: {\n              color: '#09c199'\n            },\n            href: `https://explorer.testnet.rsk.co/tx/${currentHash}`,\n            target: \"_blank\",\n            children: \"View on the explorer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'center'\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            onClick: () => {\n              cancelButton();\n              setCurrentHash(null);\n              setShowTransaction(false);\n            },\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => cancelButton(),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          disabled: !auth.isLoggedIn,\n          onClick: () => confirmButton({\n            comment,\n            tolerance\n          }),\n          children: \"Confirm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MintModal, \"WYng2IxgpDDsIVaWWxWZljVpbUo=\", false, function () {\n  return [useTranslation];\n});\n\n_c = MintModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"MintModal\");","map":{"version":3,"names":["Button","Collapse","Slider","SettingFilled","AuthenticateContext","useState","useContext","useEffect","Modal","notification","convertAmount","getExchangeMethod","formatValueToContract","formatValueWithContractPrecision","Copy","getCurrencyDetail","LargeNumber","formatLocalMap2","useTranslation","BigNumber","MintModal","props","isLoggedIn","exchanging","receiving","title","handleClose","handleComplete","color","token","fee","interests","visible","onCancel","onConfirm","convertToken","actionIsMint","tolerance","setTolerance","defaultSliderValue","commissionCurrency","valueYouExchange","address","console","log","btnDisable","loading","setLoading","showTransaction","setShowTransaction","transaction","setTransaction","auth","tokenNameExchange","currencyCode","longNameKey","tokenNameReceive","currentHash","setCurrentHash","comment","setComment","showError","setShowError","t","i18n","appMode","userComment","userTolerance","interval","setInterval","getTransaction","clearInterval","receivingInUSD","value","renderAmount","name","amountAndCurrencyCode","classElement","confirmButton","minimumUserBalanceToOperate","userSpendable","getSpendableBalance","window","minimumBalance","uTolerance","plus","gt","onConfirmTransactionFinish","exchangeMethod","userAmount","userToleranceAmount","multipliedBy","div","toFixed","enoughMOCBalance","web3","utils","fromWei","percentage","toString","userToleranceFormat","interfaceExchangeMethod","onTransaction","onReceipt","callback","error","transactionHash","receipt","loadContractsStatusAndUserBalance","filteredEvents","interfaceDecodeEvents","renderError","hash","getTransactionReceipt","then","res","catch","e","message","description","duration","changeTolerance","newTolerance","cancelButton","markStyle","style","fontSize","priceVariationToleranceMarks","label","styleExchange","styleReceive","val","alignItems","marginBottom","undefined","interestValue","interestRate","border","marginTop","display","justifyContent","width","float","textAlign","slice","clear"],"sources":["C:/Users/micae/OneDrive/Documentos/CoinFabrik/webapp-stable-ipfs/src/Components/Modals/MintModal/index.jsx"],"sourcesContent":["/* eslint-disable default-case */\r\n/* eslint-disable react/jsx-no-target-blank */\r\nimport { Button, Collapse, Slider } from 'antd';\r\nimport { SettingFilled } from '@ant-design/icons';\r\nimport { AuthenticateContext } from '../../../Context/Auth';\r\nimport './style.scss';\r\nimport { useState, useContext, useEffect } from 'react';\r\nimport { Modal, notification } from 'antd';\r\n\r\nimport { convertAmount } from '../../../Lib/exchangeManagerHelper';\r\nimport { getExchangeMethod } from '../../../Lib/exchangeHelper';\r\nimport {\r\n  formatValueToContract,\r\n  formatValueWithContractPrecision,\r\n} from '../../../Lib/Formats';\r\nimport Copy from \"../../Page/Copy\";\r\nimport { getCurrencyDetail } from '../../../Config/currentcy';\r\nimport { LargeNumber } from '../../LargeNumber';\r\nimport {formatLocalMap2} from '../../../Lib/Formats';\r\nimport { useTranslation } from \"react-i18next\";\r\nimport BigNumber from 'bignumber.js';\r\nexport default function MintModal(props) {\r\n  const isLoggedIn = true; //userAccountIsLoggedIn() && Session.get('rLoginConnected');\r\n  const {\r\n    exchanging,\r\n    receiving,\r\n    title = '',\r\n    handleClose = () => {},\r\n    handleComplete = () => {},\r\n    color,\r\n    token,\r\n    fee,\r\n    interests,\r\n    visible,\r\n    onCancel,\r\n    onConfirm,\r\n    convertToken,\r\n    actionIsMint,\r\n    tolerance,\r\n    setTolerance,\r\n    defaultSliderValue,\r\n    commissionCurrency,\r\n    valueYouExchange,\r\n  } = props;\r\n  /* Disabled confirm button when not connected */\r\n  const { address } = true; //window;\r\n  console.log('export default function MintModal(props) {');\r\n  console.log(fee);\r\n  console.log(valueYouExchange);\r\n  console.log('export default function MintModal(props) {');\r\n  var btnDisable = false;\r\n  if (!address || !isLoggedIn) {\r\n    btnDisable = true;\r\n  }\r\n  const [loading, setLoading] = useState(false);\r\n  const [showTransaction, setShowTransaction] = useState(false);\r\n  const [transaction, setTransaction] = useState(false);\r\n  const auth = useContext(AuthenticateContext);\r\n  const tokenNameExchange = exchanging.currencyCode\r\n    ? getCurrencyDetail(exchanging.currencyCode).longNameKey\r\n    : '';\r\n  const tokenNameReceive = receiving.currencyCode\r\n    ? getCurrencyDetail(receiving.currencyCode).longNameKey\r\n    : '';\r\n\r\n  const [currentHash, setCurrentHash] = useState(null);\r\n  const [comment, setComment] = useState('');\r\n  const [showError, setShowError] = useState(false);\r\n  const [t, i18n]= useTranslation([\"global\",'moc'])\r\n  const { appMode } = 'Moc';\r\n\r\n  let userComment = '';\r\n  let userTolerance = '';\r\n\r\n  useEffect(() => {\r\n      if (currentHash) {\r\n        console.log('currentHash', currentHash);\r\n          const interval = setInterval(() => {\r\n              getTransaction(currentHash)\r\n          }, 15000);\r\n          return () => clearInterval(interval);\r\n      }\r\n  }, [currentHash]);\r\n  useEffect(\r\n    () => {\r\n      setComment('');\r\n    },\r\n    [visible]\r\n  );\r\n\r\n  const receivingInUSD = convertAmount(\r\n    receiving.currencyCode,\r\n    'USD',\r\n    receiving.value,\r\n    convertToken\r\n  );\r\n  /* View */\r\n  const renderAmount = (name, amountAndCurrencyCode, classElement) => {\r\n    return (\r\n      <div className={`AlignedAndCentered Amount ${classElement}`}>\r\n        <span className=\"Name\">{name}</span>\r\n        <span className={`Value ${amountAndCurrencyCode.currencyCode} ${appMode}`}>\r\n          <LargeNumber\r\n            currencyCode={amountAndCurrencyCode.currencyCode}\r\n            amount={amountAndCurrencyCode.value}\r\n            includeCurrency\r\n          />\r\n        </span>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const confirmButton = async ({comment, tolerance}) => {\r\nconsole.log('confirmButtonconfirmButton*******************')\r\n    // return false\r\n    // Check if there are enough spendable balance to pay\r\n    // take in care amount to pay gas fee\r\n    const minimumUserBalanceToOperate = \"120000000000000\";\r\n    const userSpendable = await auth.getSpendableBalance(window.address);\r\n\r\n    let minimumBalance = new BigNumber(minimumUserBalanceToOperate);\r\n    let uTolerance = 0;\r\n    if (actionIsMint) {\r\n        minimumBalance = minimumBalance.plus(new BigNumber(exchanging.value));\r\n        uTolerance = tolerance;\r\n    }\r\n\r\n    // You have not enough balance abort\r\n    if (minimumBalance.gt(new BigNumber(userSpendable))) {\r\n        setShowError(true);\r\n        return;\r\n    }\r\n    // onConfirm({ comment, tolerance: uTolerance });\r\n    userComment = comment;\r\n    userTolerance = uTolerance;\r\n\r\n    /* const { appMode } = window;\r\n    // In rrc20 mode show allowance when need it\r\n    if (appMode === 'RRC20') {\r\n      const userAllowance = await window.nodeManager.getReserveAllowance(window.address);\r\n      if (valueYouExchange > userAllowance) {\r\n        allowanceReserveModalShow(true);\r\n        return;\r\n      }\r\n    } */\r\n    onConfirmTransactionFinish();\r\n\r\n  };\r\n\r\n  const onConfirmTransactionFinish = async () => {\r\n    const exchangeMethod = getExchangeMethod(\r\n      exchanging.currencyCode,\r\n      receiving.currencyCode,\r\n      `${commissionCurrency}_COMMISSION`\r\n    );\r\n    let userAmount = formatValueWithContractPrecision(valueYouExchange, 'RESERVE');\r\n    const userToleranceAmount = formatValueToContract(\r\n      new BigNumber(userTolerance)\r\n          .multipliedBy(userAmount)\r\n          .div(100)\r\n          .toFixed(),\r\n      'RESERVE'\r\n    );\r\n    if( fee.enoughMOCBalance==true ){\r\n      userAmount= userAmount - window.web3.utils.fromWei(((fee.percentage)*100).toString(), 'ether')\r\n    }\r\n    const userToleranceFormat = new BigNumber(userTolerance).toFixed();\r\n    //exchangeMethod(userAmount, userToleranceAmount, callback).then((res) => console.log(res, callback))\r\n    //auth.interfaceMintRiskPro(userAmount, userToleranceFormat, callback);\r\n    auth.interfaceExchangeMethod(exchanging.currencyCode, receiving.currencyCode, userAmount, userToleranceFormat, onTransaction, onReceipt);\r\n  };\r\n\r\n  const callback = (error, transactionHash) => {\r\n    setLoading(false);\r\n    setCurrentHash(transactionHash);\r\n    setShowTransaction(true);\r\n    getTransaction(transactionHash);\r\n  };\r\n\r\n  const onTransaction = (transactionHash) => {\r\n    setLoading(false);\r\n    setCurrentHash(transactionHash);\r\n    setShowTransaction(true);\r\n    getTransaction(transactionHash);\r\n  };\r\n\r\n  const onReceipt = async (receipt) => {\r\n    auth.loadContractsStatusAndUserBalance()\r\n    const filteredEvents = auth.interfaceDecodeEvents(receipt);\r\n  };\r\n\r\n  const renderError = () => {\r\n    return (\r\n    <div className=\"noEnoughBalance\">\r\n      {t('global.ConfirmTransactionModal_Error_not_enough')}\r\n    </div>\r\n    )\r\n  };\r\n\r\n  const getTransaction = async (hash) => {\r\n    await auth.getTransactionReceipt(hash, ()=> {\r\n      setTransaction(false);\r\n    }).then(res => {\r\n      if (res) {\r\n        setShowTransaction(true);\r\n        setTransaction(true);\r\n      }\r\n    }).catch(e => {\r\n      setTransaction(false);\r\n      notification['error']({\r\n        message: t('global.RewardsError_Title'),\r\n        description: t('global.RewardsError_Message'),\r\n        duration: 10\r\n    });\r\n    });\r\n  } ;\r\n\r\n  const changeTolerance = (newTolerance) => {\r\n    setTolerance(newTolerance);\r\n    setShowError(false);\r\n  };\r\n\r\n  const cancelButton = () => {\r\n    setShowError(false);\r\n    onCancel();\r\n  };\r\n\r\n  const markStyle = {\r\n    style: {\r\n      color: '#707070',\r\n      fontSize: 10\r\n    }\r\n  };\r\n\r\n  const priceVariationToleranceMarks = {\r\n    0: { ...markStyle, label: '0.0%' },\r\n    1: { ...markStyle, label: '1%' },\r\n    2: { ...markStyle, label: '2%' },\r\n    5: { ...markStyle, label: '5%' },\r\n    10: { ...markStyle, label: '10%' }\r\n  };\r\n\r\n  const styleExchange = tokenNameExchange === exchanging.currencyCode ? { color } : {};\r\n  const styleReceive = tokenNameReceive === receiving.currencyCode ? { color } : {};\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      confirmLoading={loading}\r\n      className=\"ConfirmModalTransaction\"\r\n      footer={null}\r\n      onCancel={cancelButton}\r\n    >\r\n      <div className=\"TabularContent\">\r\n        <h1>{t('global.ConfirmTransactionModal_Title')}</h1>\r\n        {renderAmount(t('global.ConfirmTransactionModal_Exchanging'), exchanging, 'AmountExchanging')}\r\n        {showError && renderError()}\r\n        {renderAmount(t('global.ConfirmTransactionModal_Receiving'), receiving, 'AmountReceiving')}\r\n        <div className=\"USDConversion\">\r\n          <LargeNumber currencyCode={'USD'} amount={receivingInUSD} includeCurrency />\r\n        </div>\r\n        <Collapse className=\"CollapseTolerance\">\r\n          <Collapse.Panel showArrow={false} header={<div className=\"PriceVariationSetting\">\r\n            <SettingFilled className=\"icon\"/>\r\n            <span className=\"SliderText\">{t(\"global.CustomizePrize_VariationToleranceSettingsTitle\")}</span>\r\n          </div>}>\r\n            <div className=\"PriceVariationContainer\">\r\n              <h4>{t(\"global.CustomizePrize_VariationToleranceTitle\")}</h4>\r\n              <Slider\r\n                className=\"SliderControl\"\r\n                marks={priceVariationToleranceMarks}\r\n                defaultValue={defaultSliderValue}\r\n                min={0}\r\n                max={10}\r\n                step={0.1}\r\n                dots={false}\r\n                onChange={val => changeTolerance(val)}\r\n              />\r\n            </div>\r\n          </Collapse.Panel>\r\n        </Collapse>\r\n        <div\r\n          className=\"AlignedAndCentered\"\r\n          style={{ alignItems: 'start', marginBottom: 20 }}\r\n        >\r\n          <div className=\"Name\">\r\n            <div className=\"MOCFee\">\r\n              <div className={`AlignedAndCentered Amount`}>\r\n                <span className=\"Name\">{`${t('global.ConfirmTransactionModal_MOCFee')} (${(fee?.percentage!==undefined)? fee.percentage: 0.15}%)`}</span>\r\n                <span className={`Value ${appMode}`}>\r\n                  {auth.isLoggedIn &&\r\n                  <LargeNumber\r\n                    currencyCode={fee?.currencyCode}\r\n                    amount={fee?.value}\r\n                    includeCurrency\r\n                  />}\r\n                  {!auth.isLoggedIn && <span>0.000000 RBTC</span>}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            {interests &&\r\n              interests?.interestValue &&\r\n              interests?.interestValue.gt(0) && (\r\n                <div className=\"MOCFee\">\r\n                  <div className={`AlignedAndCentered Amount`}>\r\n                    <span className=\"Name\">{`${t('global.ConfirmTransactionModal_Interests')} (${interests?.interestRate}%)`}</span>\r\n                    <span className={`Value ${appMode}`}>\r\n                      <LargeNumber\r\n                        currencyCode={'RESERVE' }\r\n                        amount={interests.interestValue}\r\n                        includeCurrency\r\n                      />\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n          )}\r\n            <div className=\"Legend\">\r\n            {t('global.ConfirmTransactionModal_MOCFee_Disclaimer')}\r\n            </div>\r\n          </div>\r\n          {/*<span className=\"Value\">0.00 MOC</span>*/}\r\n        </div>\r\n      </div>\r\n\r\n      <hr style={{ border: '1px solid lightgray', marginTop: 20 }} />\r\n\r\n      <div className=\"AlignedAndCentered\">\r\n        <i className=\"Gray\">\r\n          {t('global.ConfirmTransactionModal_AmountMayDifferDisclaimer')}\r\n        </i>\r\n      </div>\r\n      <div style={{ display: 'flex', justifyContent: 'space-around', marginTop: '1em'}}>\r\n        {showTransaction\r\n          ? <div style={{ width: '100%' }}>\r\n            <div>\r\n              <p style={{ width: '50%', float: 'left' }}>Transaction status</p>\r\n              <p style={{ textAlign: 'right', color: transaction ? '#09c199' : '#f1a954' }}>{transaction ? 'SUCCESSFUL' : 'PENDING'}</p>\r\n            </div>\r\n            <div>\r\n              <p style={{ width: '50%', float: 'left' }}>Hash</p>\r\n              <div style={{ textAlign: 'right' }}>\r\n                <Copy textToShow={currentHash?.slice(0, 5)+'...'+ currentHash?.slice(-4)} textToCopy={currentHash}/>\r\n              </div>\r\n            </div>\r\n            <div style={{ clear: 'both' }}>\r\n              <a\r\n                style={{ color: '#09c199' }}\r\n                href={`https://explorer.testnet.rsk.co/tx/${currentHash}`}\r\n                target=\"_blank\"\r\n              >View on the explorer</a>\r\n            </div>\r\n            <div style={{ display: 'flex', justifyContent: 'center'}}>\r\n              <Button type=\"primary\" onClick={() => {cancelButton(); setCurrentHash(null); setShowTransaction(false)}}>Close</Button>\r\n            </div>\r\n          </div>\r\n          : <>\r\n            <Button\r\n              onClick={() => cancelButton()}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              type=\"primary\"\r\n              disabled={!auth.isLoggedIn}\r\n              onClick={() => confirmButton({ comment, tolerance })}\r\n            >Confirm</Button>\r\n        </>}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}